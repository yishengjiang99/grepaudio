
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>rt</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="./simple-console.css">
    <script src="./simple-console.js"></script>
</head>

<body onclick="void(0);">
  <div id="overlay" title="Click to turn off the overlay effect" style="display: block;">
        <div class="text">overlay blocker</div>
        <div class="text"><br>
            <br><span style="font-size:20px;" class="w3-black w3-padding w3-hide-medium w3-hide-small">
                Click anywhere to turn off the overlay effect
            </span></div>
    </div>
    <div>
        <h3>Mix Sounds </h3> 
    </div>

    <div class='container' style='margin:20px;position:relative'>
        <table>
          <tr>
            <td>
              <div> pre-amp Volume:&nbsp;&nbsp;&nbsp;&nbsp;
                <input type="range" id="volume" class="control-volume" min="-1" max="4" value="1"
                list="gain-vals" step="0.01"
                oninput="event.target.nextElementSibling.innerText=event.target.value"
                data-action="volume" /> <span></span>
              </div>

              <div> second amp Volume:
                <input type="range" id="volume2" class="control-volume" min="0" max="3" value="1"
                list="gain-vals" step="0.01"
                oninput="event.target.nextElementSibling.innerText=event.target.value"
                data-action="volume" /><span></span>
              </div>
            </td>
            <button id='miccheck'>use microphone</button>

            <td style='text-align:right'>
              <form>
                <label for="search">Search</label>

                <input type=text id='ytsearch' placeholder='search youtube' size=30 data-host='https://dsp.grepawk.com/api/sudo/::QUERY::.mp3' />
              </form>
              <div id='autosuggest'>

              </div>
            </td>

            <td rowspan=2>
              <span id=ctrls>


              </span>
              <div id='recorder'>
                <button data-state='init' style='display:inline' id='rec'>record</button>
                <button style='display:none' id='rec-done'>Finish</button>
                <div id="rec-rx1"></div>
                <canvas id=c1></canvas>
              </div>
                <div id='like_button_container'></div>

            </td>
          </tr>
            <tr>
                <td rowspan=2 colspan=1>
                    <button id='reset'>reset</button>
                    <form id="eq_update_form">

                    </form>
                    <audio id='audio' src='./samples/song.mp3'></audio>
                </td>
                <td>
                    <div class='canvas_wrapper'>
                      <span>
                      <input id='showfft' type=checkbox checked>show</input></span>
                      <input id='showcummulative' type=checkbox checked>show cummulative fft</input>
                      <input id='showtimeseries' type=checkbox checked>showtimesseries</input>
                      <button id='zoomin'>+</button>    <button id='zoomin'>-</button>
                      </span>
                      <canvas id='output_freq'></canvas></div>
                      <canvas id='output_timeline'></canvas></div>

                </td>
                <td>
                    <div class='canvas_wrapper'><canvas id='input_freq'></canvas></div>
                </td>
            </tr>
            <tr><td>
              <div id="equalizer"></div>
            </td></tr>
            <tr>
                <td align=left colspan=1>
                    <div id=console></div>
                </td>
                <td>
                </td>
            </tr>
        </table>
        <div id="rx1"></div>
        <div id='rx1'></div>
        <div id='rx2log'></div>

    </div>


    <script src='polyfills.js'></script>


    <script type='module'>

        import equilizer from "./equalizer.js";
        import Mixer from './Mixer.js';
        import Recorder from './recording/index.js';

        let audioCtx, audioTag, eq;

        $("#overlay").onclick = async function (e) {
          $("#overlay").style.zIndex=-99;

            this.style.display='none';

            audioCtx = new AudioContext();

            var audioTag =await Mixer(audioCtx, "ctrls");

//            audioTag.add_audio_tag("audio");
            window.g_audioTag = audioTag;
            window.g_audioCtx = audioCtx;

            eq = equilizer.initializeContext(audioCtx, audioTag.outputNode);

          var recorder=  Recorder(audioCtx, 'recorder');
          //  const recorder = new Recorder();

//              var dest = audioCtx.createMediaStreamDestination();
  //            var mediaRecorder = new MediaRecorder(dest.stream);

          }


    </script>
      
</body>

</html>
